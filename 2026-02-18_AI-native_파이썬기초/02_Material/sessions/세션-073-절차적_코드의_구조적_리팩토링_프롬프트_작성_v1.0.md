# 세션 073 — 절차적 코드의 구조적 리팩토링 프롬프트 작성

| 항목 | 내용 |
|------|------|
| **세션 ID** | MS-PY101-073 |
| **소요 시간** | 20분 |
| **난이도** | ★★☆ |
| **청크 타입** | lab |
| **선행 세션** | 세션-072 (필수) |
| **학습 목표** | 절차적 코드를 기능별 함수로 분리하고 전역 변수를 제거하도록 요구하는 구조적 리팩토링 프롬프트를 작성할 수 있다 |
| **출처** | [A] 8 코딩.pdf §8.10 · [B] NotebookLM §5 · [C] Deep Research §2.2, 5.1 |

---

## ① 도입 — "겉은 그대로, 속은 새롭게"

🗣️ 강사 대본 (Instructor Script):

지난 시간에 우리는 우리가 짠 코드가 작동은 하지만 구조적으로 얼마나 엉성한지 확인했습니다. 전역 변수가 방치되어 있고, 똑같은 코드가 여기저기 복사되어 있었죠. 이제 이 스파게티처럼 엉킨 코드를 아주 예쁘고 깔끔하게 다시 정리해 볼 시간입니다. 프로그래밍 세계에서는 이렇게 프로그램의 겉모습이나 동작은 전혀 바꾸지 않은 채, 내부의 코드 구조만 더 좋게 개선하는 작업을 가리켜 리팩토링이라고 부릅니다. 아주 매력적이고 멋진 단어죠? 예전에는 개발자들이 밤을 새워가며 엉킨 코드를 하나하나 손으로 풀어냈지만, 지금은 AI라는 강력한 조수가 있습니다. 오늘은 AI에게 우리의 절차적 코드를 기능별로 깔끔하게 분리해 달라고 지시하는 구조적 리팩토링 프롬프트를 직접 작성해 보겠습니다.

---

## ② 비유 — 원룸을 투룸으로 리모델링하기

🗣️ 강사 대본 (Instructor Script):

리팩토링의 개념을 이해하기 위해 여러분이 살고 있는 집을 한 번 상상해 봅시다. 처음에는 아무런 칸막이가 없는 거대한 원룸에서 살기 시작했습니다. 침대 옆에 가스레인지가 있고, 그 옆에 세탁기가 있고, 또 그 옆에 변기가 있습니다. 살 수는 있지만 요리할 때 이불에 냄새가 배고 손님이 오면 아주 난감해지는 구조입니다. 우리가 앞서 작성한 무한 루프 방식의 코드가 바로 이 칸막이 없는 원룸과 완벽하게 똑같습니다. 

이제 우리는 이 원룸을 리모델링할 것입니다. 거실, 침실, 주방, 화장실에 각각 튼튼한 벽을 세우고 예쁜 문을 달아줍니다. 집의 바깥에서 보는 겉모습이나 주소는 전혀 변하지 않았지만, 집 안의 구조는 목적에 맞게 완벽하게 분리되었습니다. 요리를 할 때는 주방 문만 열면 되고, 잠을 잘 때는 침실 문만 닫으면 됩니다. 코드에서 이렇게 벽을 세우고 공간을 분리해 주는 역할이 바로 함수입니다. 등록하는 공간, 조회하는 공간, 수정하는 공간, 삭제하는 공간을 각각 독립된 함수라는 방으로 만들어 주는 것이죠. 이렇게 공간을 나누면 나중에 주방의 가스레인지를 인덕션으로 바꿀 때 침실이나 화장실을 건드릴 필요가 전혀 없어집니다. 이것이 바로 우리가 리팩토링을 하는 궁극적인 이유입니다.

---

## ③ 개념 — 함수 분리와 전역 변수 제거를 향한 프롬프팅

🗣️ 강사 대본 (Instructor Script):

성공적인 리팩토링을 위해 AI에게 전달해야 할 핵심 지시사항은 크게 두 가지입니다. 첫째, 각 메뉴의 기능을 독립된 함수로 분리해 달라고 명확히 요청해야 합니다. 무한 루프 안에 엉켜있던 로직들을 밖으로 꺼내서 Create, Read, Update, Delete 각각을 전담하는 def 함수들로 만들어 달라고 하는 것이죠. 이렇게 하면 중복되던 검색 로직도 별도의 함수 하나로 예쁘게 빼낼 수 있습니다[A 8 코딩.pdf §8.10]. 둘째, 코드 맨 위에 덩그러니 놓여있던 전역 변수 리스트를 메인 함수 안으로 숨겨달라고 요구해야 합니다. 공용 금고를 없애고 메인 함수라는 안전한 방 안에 개인 금고로 만들어 달라는 뜻입니다. 최근 문헌에 따르면 전역 상태를 제거하는 것만으로도 코드의 안정성이 비약적으로 상승한다고 합니다[B NotebookLM §5]. 

우리가 AI에게 입력할 프롬프트는 "이 코드를 리팩토링해줘"라는 단순한 문장이 되어서는 안 됩니다. "현재 전역 변수로 선언된 리스트를 메인 함수 내부의 지역 변수로 변경하고, CRUD 각각의 기능을 독립된 4개의 함수로 분리해 줘. 그리고 프로그램의 겉보기 동작은 기존과 똑같이 유지해 줘"라고 아주 구체적이고 단호하게 지시해야 합니다[C Deep Research §2.2, 5.1]. 이렇게 목적이 뚜렷한 프롬프트를 던질 때 AI는 가장 완벽한 형태의 구조적 개선 코드를 우리에게 선물합니다.

---

## ④ 실습 — AI 조수와 함께하는 구조 개편

🎙️ 실습 가이드 (Lab Guide):

| 단계 | 소요시간 | 활동 내용 | 달성 목표 |
|---|---|---|---|
| 1 | 5분 | AI 챗봇에 기존 코드와 함께 구체적인 리팩토링 프롬프트 입력하기 | 의도가 정확히 반영된 함수 분리형 코드를 응답으로 받기 |
| 2 | 5분 | 응답받은 코드를 기존 코드와 구별하여 v2.py 라는 새 파일로 저장하고 실행하기 | 겉보기 동작이 100% 동일하게 작동하는지 통합 테스트 진행 |
| 3 | 5분 | 새로 작성된 코드의 구조를 눈으로 훑으며 def 키워드의 개수 세어보기 | 로직이 몇 개의 독립된 함수로 쪼개졌는지 시각적으로 확인 |

🗣️ 강사 대본 (Instructor Script):

자, 이제 여러분의 AI 챗봇 창을 열어주세요. 방금 전까지 우리가 다루었던 그 길고 엉켜있던 코드를 전체 복사해서 붙여넣습니다. 그리고 그 밑에 여러분만의 리팩토링 프롬프트를 작성해 보세요. 방금 배운 대로 함수 분리와 전역 변수 제거라는 키워드가 반드시 들어가야 합니다. AI가 답변을 주면, 그 코드를 복사해서 파이썬 편집기에 v2.py라는 새로운 이름으로 저장합니다. 저장한 코드를 실행해 보세요. 신기하게도 화면에 나오는 메뉴나 동작 방식은 이전과 완전히 똑같을 것입니다. 1번을 누르면 등록이 되고 2번을 누르면 조회가 되죠. 하지만 이제 코드를 위에서부터 천천히 스크롤 해보십시오. 이전에는 볼 수 없었던 def 라는 단어들이 여러 개 보일 것입니다. 원룸이었던 코드에 멋진 방들이 여러 개 생겨난 것입니다.

---

## ⑤ 정리 — 진정한 개발자의 시각을 갖추다

🗣️ 강사 대본 (Instructor Script):

정말 고생 많으셨습니다. 여러분은 오늘 겉보기엔 똑같이 작동하는 프로그램이지만, 내부 코드는 완전히 다르게 진화한 구조를 눈으로 직접 확인하셨습니다. 기능을 추가하는 데 급급했던 초보자의 시야에서 벗어나, 코드의 유지보수성과 아름다움을 고민하는 진정한 개발자의 시야를 갖게 된 것입니다. 이렇게 잘 정리된 구조가 있어야만 우리는 다음 단계인 파일 저장이나 데이터베이스 연동으로 넘어갈 수 있습니다.

> **체크포인트**: "프로그램의 외부 동작은 전혀 바꾸지 않은 채, 내부의 구조만을 깔끔하고 효율적으로 개선하는 이 작업을 무엇이라고 부를까요?" — 정답은 리팩토링(Refactoring) 입니다!