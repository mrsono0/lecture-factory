name: "Nano Banana PPTX Generation Pipeline"
description: "03_visualizerê°€ ìƒì„±í•œ ìŠ¬ë¼ì´ë“œ ì½˜í…ì¸ ë¥¼ Nano Banana Pro(Gemini 3 Pro Image Preview) ëª¨ë¸ë¡œ ê³ í’ˆì§ˆ ì´ë¯¸ì§€ ìŠ¬ë¼ì´ë“œë¥¼ ìƒì„±í•˜ê³  PPTXë¡œ ì¡°ë¦½í•˜ëŠ” ì›Œí¬í”Œë¡œìš° (6ì¸ ì—ì´ì „íŠ¸ íŒ€). ê° ìŠ¬ë¼ì´ë“œë¥¼ AI ì´ë¯¸ì§€ë¡œ ìƒì„±í•˜ì—¬ ê¸€ë˜ìŠ¤ëª¨í”¼ì¦˜/ë²¤í† ê·¸ë¦¬ë“œ ë“± ê³ ê¸‰ ë¹„ì£¼ì–¼ ìŠ¤íƒ€ì¼ì„ ì ìš©í•©ë‹ˆë‹¤. âš ï¸ MUST ANALYZE CONTEXT: If a local folder is provided, analyze its contents using list_dir/read_file BEFORE proceeding."
version: "1.1"
skill_dependencies:
  - nanobanana-ppt-skills
  - imagen
  - gemini-api-dev
  - pptx-official
  - last30days
required_env:
  - GEMINI_API_KEY

output_path: "{YYYY-MM-DD_ê°•ì˜ì œëª©}/06_NanoPPTX/ìµœì¢…_í”„ë ˆì  í…Œì´ì…˜.pptx"
max_retries: 2

logging:
  enabled: true
  protocol: ".agent/logging-protocol.md"
  model_config: ".opencode/oh-my-opencode.jsonc"
  path: ".agent/logs/{YYYY-MM-DD}_06_NanoBanana_PPTX.jsonl"
  format: "jsonl"

steps:
  # Phase 1: ì‚¬ì „ ì¤€ë¹„
  - id: step_1_skill_load
    agent: "06_nanopptx/C0_Orchestrator"
    action: "load_skills"
    input: "nanobanana-ppt-skills SKILL.md, imagen SKILL.md, gemini-api-dev SKILL.md, pptx-official SKILL.md, last30days SKILL.md (Nano Banana Pro prompting techniques)"
    output: "Skill Knowledge Loaded, Available Styles List"
    description: "ê´€ë ¨ ìŠ¤í‚¬ ë¬¸ì„œë¥¼ ë¡œë“œí•˜ê³ , ì‚¬ìš© ê°€ëŠ¥í•œ ë¹„ì£¼ì–¼ ìŠ¤íƒ€ì¼ ëª©ë¡ì„ í™•ì¸í•©ë‹ˆë‹¤."

  - id: step_2_input_validation
    agent: "06_nanopptx/C0_Orchestrator"
    action: "validate_input"
    depends_on: "step_1_skill_load"
    input: "03_Slides/ directory (Slide Sequence Map, Layout Specs, Design Tokens), GEMINI_API_KEY, Output Language: Korean"
    output: "Validated Input Manifest, Selected Style, Resolution"
    description: "03_visualizer ì‚°ì¶œë¬¼ì´ ì™„ì „í•œì§€ ê²€ì¦í•˜ê³ , ìŠ¤íƒ€ì¼(gradient-glass/vector-illustration)ê³¼ í•´ìƒë„(2K/4K)ë¥¼ ê²°ì •í•©ë‹ˆë‹¤."

  # Phase 2: ì½˜í…ì¸  í”Œë˜ë‹
  - id: step_3_content_planning
    agent: "06_nanopptx/C1_Content_Planner"
    action: "create_slide_plan"
    depends_on: "step_2_input_validation"
    input: "Slide Markdown files, Slide Sequence Map, Design Tokens, Output Language: Korean"
    output: "slides_plan.json, speaker_notes.json, Asset Request Summary"
    description: "ìŠ¬ë¼ì´ë“œ ë§ˆí¬ë‹¤ìš´ì„ ë¶„ì„í•˜ì—¬ Nano Banana Pro ì´ë¯¸ì§€ ìƒì„±ì— ìµœì í™”ëœ êµ¬ì¡°í™” ë°ì´í„°(slides_plan.json)ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. í…ìŠ¤íŠ¸ ì••ì¶•, ìœ í˜• ë§¤í•‘(cover/content/data), ì‹œê° ìš”ì†Œ ì§€ì‹œë¥¼ í¬í•¨í•©ë‹ˆë‹¤."

  # Phase 3: í”„ë¡¬í”„íŠ¸ ìƒì„±
  - id: step_4_prompt_engineering
    agent: "06_nanopptx/C2_Prompt_Engineer"
    action: "generate_prompts"
    depends_on: "step_3_content_planning"
    input: "slides_plan.json, Selected Style Template, Nano Banana Pro prompting best practices, Output Language: Korean"
    output: "slide_prompts.json, style_preamble.md"
    description: "ìŠ¬ë¼ì´ë“œë³„ ì´ë¯¸ì§€ ìƒì„± í”„ë¡¬í”„íŠ¸ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤. JSON êµ¬ì¡° í”„ë¡¬í”„íŠ¸ íŒ¨í„´, ìŠ¤íƒ€ì¼ í”„ë¦¬ì•°ë¸”, í•œê¸€ í…ìŠ¤íŠ¸ ë Œë”ë§ ì „ëµì„ ì ìš©í•©ë‹ˆë‹¤."

  # Phase 4: ì´ë¯¸ì§€ ìƒì„±
  - id: step_5_image_generation
    agent: "06_nanopptx/C3_Image_Generator"
    action: "generate_images"
    depends_on: "step_4_prompt_engineering"
    input: "slide_prompts.json, Style Template, Resolution config, Output Language: Korean"
    output: "Slide PNG images (slide-01.png ~ slide-NN.png), Generation Log"
    description: "Nano Banana Pro(gemini-3-pro-image-preview)ë¥¼ í˜¸ì¶œí•˜ì—¬ ê° ìŠ¬ë¼ì´ë“œë¥¼ 16:9 ì´ë¯¸ì§€ë¡œ ìƒì„±í•©ë‹ˆë‹¤. generate_ppt.py ìŠ¤í¬ë¦½íŠ¸ ë˜ëŠ” Gemini API ì§ì ‘ í˜¸ì¶œì„ ì‚¬ìš©í•©ë‹ˆë‹¤."

    notes: |
      ğŸ“Š External Tool Logging: C3_Image_Generator must log each Gemini API call
      (gemini-3-pro-image-preview) to .agent/logs/{DATE}_06_NanoBanana_PPTX.jsonl
      using EXTERNAL_TOOL_START/END events. See C3_Image_Generator.md Â§ì™¸ë¶€ ë„êµ¬ í˜¸ì¶œ ë¡œê¹….

  # Phase 5: PPTX ì¡°ë¦½
  - id: step_6_pptx_build
    agent: "06_nanopptx/C4_PPTX_Builder"
    action: "build_pptx"
    depends_on: "step_5_image_generation"
    input: "Slide PNG images, slides_plan.json, speaker_notes.json, Output Language: Korean"
    output: "Draft PPTX file, HTML Viewer, Build Log"
    description: "ìƒì„±ëœ ì´ë¯¸ì§€ë¥¼ PptxGenJS ë˜ëŠ” python-pptxë¡œ PPTXì— ì‚½ì…í•©ë‹ˆë‹¤. ê° ìŠ¬ë¼ì´ë“œì— ì´ë¯¸ì§€(ì „ì²´ ì»¤ë²„) + Speaker Notesë¥¼ ì¶”ê°€í•˜ê³ , ì¸í„°ë™í‹°ë¸Œ HTML ë·°ì–´ë„ ìƒì„±í•©ë‹ˆë‹¤."

  # Phase 6: í’ˆì§ˆ ê²€ì¦ ë° ìˆ˜ì • ë£¨í”„
  - id: step_7_visual_qa
    agent: "06_nanopptx/C5_Visual_QA"
    action: "inspect_quality"
    depends_on: "step_6_pptx_build"
    input: "Draft PPTX file, Slide PNG images, slides_plan.json, Output Language: Korean"
    output: "Thumbnail Grid, QA Report, Text Verification Report"
    description: "ì¸ë„¤ì¼ ê·¸ë¦¬ë“œë¥¼ ìƒì„±í•˜ê³  ì‹œê° í’ˆì§ˆ, í…ìŠ¤íŠ¸ ì •í™•ì„±(í•œê¸€ ì™œê³¡, ì½”ë“œ ì˜¤ë¥˜), ìŠ¤íƒ€ì¼ ì¼ê´€ì„±ì„ ê²€ì‚¬í•©ë‹ˆë‹¤."

  - id: step_8_fix_loop
    agent: "06_nanopptx/C0_Orchestrator"
    action: "coordinate_fixes"
    depends_on: "step_7_visual_qa"
    input: "QA Report, Text Verification Report, Output Language: Korean"
    output: "Fix Instructions or Final Approval"
    decision:
      approved: "step_9_finalize"
      conditional: "step_9_finalize (ë…¸íŠ¸ í¬í•¨ ì €ì¥)"
      partial_regen: "step_4_prompt_engineering (í•´ë‹¹ ìŠ¬ë¼ì´ë“œë§Œ ì¬ìƒì„±)"
      rejected: "step_3_content_planning (ìµœëŒ€ 2íšŒ ì¬ì‹¤í–‰)"
    description: "QA ê²°ê³¼ë¥¼ ë¶„ì„í•©ë‹ˆë‹¤. í…ìŠ¤íŠ¸ ì™œê³¡ ìŠ¬ë¼ì´ë“œë§Œ ë¶€ë¶„ ì¬ìƒì„±(Partial Regen â†’ step_4)í•˜ê±°ë‚˜, ì „ì²´ ë°˜ë ¤ ì‹œ ì½˜í…ì¸  í”Œë˜ë‹(step_3)ë¶€í„° ì¬ì‹¤í–‰í•©ë‹ˆë‹¤."

  # Phase 7: ìµœì¢… ì‚°ì¶œë¬¼
  - id: step_9_finalize
    agent: "06_nanopptx/C0_Orchestrator"
    action: "finalize_output"
    depends_on: "step_8_fix_loop"
    input: "Approved PPTX file, QA Report, Generation Log, Output Language: Korean"
    output: "Final PPTX file, Conversion Report, Interactive Viewer"
    description: "ìµœì¢… PPTX íŒŒì¼ ëª…ëª…, ë³€í™˜ ë¦¬í¬íŠ¸ ì‘ì„±(ìƒì„± ì‹œê°„, ë¹„ìš© ì¶”ì •, ì¬ìƒì„± ì´ë ¥), í”„ë¡œì íŠ¸ í´ë” ì •ë¦¬ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤."
