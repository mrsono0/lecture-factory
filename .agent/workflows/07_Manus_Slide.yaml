name: "Manus Slide Generation Pipeline"
description: "04_SlidePromptê°€ ìƒì„±í•œ ìŠ¬ë¼ì´ë“œ í”„ë¡¬í”„íŠ¸ë¥¼ êµì‹œ ë‹¨ìœ„ë¡œ ë¶„í• í•˜ì—¬ Manus AI(Nano Banana Pro)ì— ì œì¶œí•˜ê³ , PPTXë¥¼ ë‹¤ìš´ë¡œë“œÂ·ë³‘í•©í•˜ëŠ” ì›Œí¬í”Œë¡œìš° (6ì¸ ì—ì´ì „íŠ¸ íŒ€). ëŒ€í˜• í”„ë¡¬í”„íŠ¸(1000ì¤„+)ëŠ” ì„¸ì…˜ ê²½ê³„ì—ì„œ ìë™ ë¶„í• ë˜ì–´ í’ˆì§ˆê³¼ ì•ˆì •ì„±ì„ í™•ë³´í•©ë‹ˆë‹¤. âš ï¸ MUST ANALYZE CONTEXT: If a local folder is provided, analyze its contents using list_dir/read_file BEFORE proceeding."
version: "1.1"
required_env:
  - MANUS_API_KEY

output_path: "{YYYY-MM-DD_ê°•ì˜ì œëª©}/07_ManusSlides/{ì„¸ì…˜ID}_{ì„¸ì…˜ì œëª©}.pptx"
max_retries: 2

logging:
  enabled: true
  protocol: ".agent/logging-protocol.md"
  model_config: ".opencode/oh-my-opencode.jsonc"
  path: ".agent/logs/{YYYY-MM-DD}_07_Manus_Slide.jsonl"
  format: "jsonl"

steps:
  # Phase 1: ì…ë ¥ íƒìƒ‰ + ê²€ì¦
  - id: step_1_input_discovery
    agent: "07_manus_slide/D0_Orchestrator"
    action: "discover_inputs"
    input: "04_SlidePrompt/ directory, MANUS_API_KEY, Output Language: Korean"
    output: "Input Manifest (prompt files list, sizes, slide counts)"
    description: "04_SlidePrompt/ í´ë”ì—ì„œ í”„ë¡¬í”„íŠ¸ íŒŒì¼ì„ íƒìƒ‰í•˜ê³ , MANUS_API_KEY ìœ íš¨ì„±ì„ í™•ì¸í•©ë‹ˆë‹¤. íŒŒì¼ë³„ ì¤„ ìˆ˜Â·ìŠ¬ë¼ì´ë“œ ìˆ˜ë¥¼ ì§‘ê³„í•˜ì—¬ ë¶„í•  í•„ìš” ì—¬ë¶€ë¥¼ ì‚¬ì „ íŒë‹¨í•©ë‹ˆë‹¤."

  - id: step_2_prompt_validation
    agent: "07_manus_slide/D1_Prompt_Validator"
    action: "validate_prompts"
    depends_on: "step_1_input_discovery"
    input: "Input Manifest, Prompt files, Output Language: Korean"
    output: "Validation Report (êµ¬ì¡° ê²€ì¦, PREFIX ì¤‘ë³µ ì²´í¬, ì„¹ì…˜ ì™„ì „ì„±)"
    description: "ê° í”„ë¡¬í”„íŠ¸ íŒŒì¼ì˜ 6ê°œ ì„¹ì…˜(â‘ ~â‘¥) êµ¬ì¡° ì™„ì „ì„±ì„ ê²€ì¦í•©ë‹ˆë‹¤. SLIDE_GENERATION_PREFIX ì¤‘ë³µ ì‚½ì… ì—¬ë¶€ë¥¼ ì²´í¬í•˜ê³ , Nano Banana Pro ë””ìì¸ ê·œì¹™ ì¤€ìˆ˜ë¥¼ í™•ì¸í•©ë‹ˆë‹¤."

  # Phase 2: êµì‹œ ë‹¨ìœ„ ë¶„í• 
  - id: step_3_chunk_splitting
    agent: "07_manus_slide/D2_Chunk_Splitter"
    action: "split_prompts"
    depends_on: "step_2_prompt_validation"
    input: "Validated Prompt files, Validation Report, Output Language: Korean"
    output: "Chunk Manifest (ë¶„í•  ê³„íš), Chunk files (ì„ì‹œ ë””ë ‰í† ë¦¬)"
    description: "1000ì¤„ ì´ìƒ ë˜ëŠ” 35ìŠ¬ë¼ì´ë“œ ì´ìƒì¸ í”„ë¡¬í”„íŠ¸ë¥¼ êµì‹œ(ì„¸ì…˜) ê²½ê³„ì—ì„œ ë¶„í• í•©ë‹ˆë‹¤. ê° ì²­í¬ì— â‘ â‘¡â‘£â‘¤ ê³µí†µ í—¤ë”ë¥¼ ë³µì œí•˜ê³ , â‘¢ ìŠ¬ë¼ì´ë“œ ëª…ì„¸ì™€ â‘¥ êµì•ˆ ì›ë¬¸ì„ ëŒ€ì‘í•˜ëŠ” ì„¸ì…˜ ë‹¨ìœ„ë¡œ ì¶”ì¶œí•©ë‹ˆë‹¤. ë¶„í•  ë¶ˆí•„ìš” íŒŒì¼ì€ ì›ë³¸ ê·¸ëŒ€ë¡œ í†µê³¼ì‹œí‚µë‹ˆë‹¤."

  # Phase 3: Manus AI ì œì¶œ + ë‹¤ìš´ë¡œë“œ
  - id: step_4_manus_submission
    agent: "07_manus_slide/D3_Submission_Manager"
    action: "submit_and_download"
    depends_on: "step_3_chunk_splitting"
    input: "Chunk Manifest, Chunk files (or original files), MANUS_API_KEY, Output Language: Korean"
    output: "Submission Log, Downloaded PPTX files (07_ManusSlides/)
    
    notes: |
      ğŸ“Š External Tool Logging: D3_Submission_Manager must log each Manus AI API call
      (create_project, upload_file, create_task) to .agent/logs/{DATE}_07_Manus_Slide.jsonl
      using EXTERNAL_TOOL_START/END events. See D3_Submission_Manager.md Â§ì™¸ë¶€ ë„êµ¬ í˜¸ì¶œ ë¡œê¹…."
    description: "manus_slide.pyë¥¼ ì‹¤í–‰í•˜ì—¬ ê° ì²­í¬(ë˜ëŠ” ì›ë³¸)ë¥¼ Manus AIì— ìˆœì°¨ ì œì¶œí•©ë‹ˆë‹¤. 30ì´ˆ ê°„ê²© í´ë§ìœ¼ë¡œ ì™„ë£Œë¥¼ ê°ì§€í•˜ê³ , PPTX íŒŒì¼ì„ 07_ManusSlides/ì— ë‹¤ìš´ë¡œë“œí•©ë‹ˆë‹¤. ì‹¤íŒ¨ ì‹œ 1íšŒ ìë™ ì¬ì‹œë„í•©ë‹ˆë‹¤."

  # Phase 4: í›„ì²˜ë¦¬ + í’ˆì§ˆ ê²€ì¦
  - id: step_5_post_processing
    agent: "07_manus_slide/D4_Post_Processor"
    action: "merge_and_cleanup"
    depends_on: "step_4_manus_submission"
    input: "Downloaded PPTX files, Chunk Manifest, Output Language: Korean"
    output: "Merged PPTX files (ì„¸ì…˜ë³„ 1ê°œ), Post-processing Report"
    description: "ë¶„í•  ì œì¶œëœ ì²­í¬ PPTXë“¤ì„ python-pptxë¡œ ë³‘í•©í•˜ì—¬ ì„¸ì…˜ë³„ ë‹¨ì¼ PPTXë¥¼ ìƒì„±í•©ë‹ˆë‹¤. í—¤ë”/í’‹í„°/í˜ì´ì§€ë²ˆí˜¸ë¥¼ í›„ì²˜ë¦¬ ì œê±°í•˜ê³ , ë°œí‘œì ë…¸íŠ¸ë¥¼ ë³„ë„ ë§ˆí¬ë‹¤ìš´ìœ¼ë¡œ ì¶”ì¶œí•©ë‹ˆë‹¤. ë¹„ë¶„í•  íŒŒì¼ì€ í›„ì²˜ë¦¬ë§Œ ìˆ˜í–‰í•©ë‹ˆë‹¤."

  - id: step_6_visual_qa
    agent: "07_manus_slide/D5_Visual_QA"
    action: "inspect_quality"
    depends_on: "step_5_post_processing"
    input: "Final PPTX files, Chunk Manifest, Prompt files (ì›ë³¸ ì°¸ì¡°), Output Language: Korean"
    output: "QA Report (ì½˜í…ì¸  ë³´ì¡´ìœ¨, ë””ìì¸ ê·œì¹™ ì¤€ìˆ˜, ë…¸íŠ¸ ì™„ì „ì„±)"
    description: "ìµœì¢… PPTXì˜ í’ˆì§ˆì„ ê²€ì‚¬í•©ë‹ˆë‹¤: â‘  ì½˜í…ì¸  ë³´ì¡´ (í”„ë¡¬í”„íŠ¸ ëŒ€ë¹„ ìŠ¬ë¼ì´ë“œ ìˆ˜, í•µì‹¬ í‚¤ì›Œë“œ ë§¤ì¹­), â‘¡ ë””ìì¸ ê·œì¹™ (í—¤ë”/í’‹í„° ë¶€ì¬, full bleed), â‘¢ ë°œí‘œì ë…¸íŠ¸ ì™„ì „ì„± (6ê°œ í•„ìˆ˜ í•­ëª©), â‘£ ì²­í¬ ê²½ê³„ ìì—°ìŠ¤ëŸ¬ì›€ (ë³‘í•© ìŠ¬ë¼ì´ë“œì˜ ì—°ì†ì„±)."

  - id: step_7_approval
    agent: "07_manus_slide/D0_Orchestrator"
    action: "review_and_decide"
    depends_on: "step_6_visual_qa"
    input: "QA Report, Post-processing Report, Output Language: Korean"
    output: "Final Decision (ìŠ¹ì¸/ì¬ì œì¶œ/ë°˜ë ¤)"
    decision:
      approved: "step_8_finalize"
      partial_resubmit: "step_4_manus_submission (í•´ë‹¹ ì²­í¬ë§Œ ì¬ì œì¶œ)"
      rejected: "step_3_chunk_splitting (ë¶„í•  ì „ëµ ì¬ì‹¤í–‰, ìµœëŒ€ 2íšŒ)"
    description: "QA ê²°ê³¼ë¥¼ ë¶„ì„í•©ë‹ˆë‹¤. í’ˆì§ˆ ê¸°ì¤€ ì¶©ì¡± ì‹œ ìŠ¹ì¸, ì¼ë¶€ ì²­í¬ë§Œ ë¬¸ì œ ì‹œ í•´ë‹¹ ì²­í¬ë§Œ ì¬ì œì¶œ(step_4), ë¶„í•  ì „ëµ ìì²´ì— ë¬¸ì œê°€ ìˆìœ¼ë©´ ë¶„í• ë¶€í„° ì¬ì‹¤í–‰(step_3)í•©ë‹ˆë‹¤."

  # Phase 5: ìµœì¢… ì‚°ì¶œë¬¼
  - id: step_8_finalize
    agent: "07_manus_slide/D0_Orchestrator"
    action: "finalize_output"
    depends_on: "step_7_approval"
    input: "Approved PPTX files, QA Report, Submission Log, Output Language: Korean"
    output: "Final PPTX files, generation_report.json, manus_task_log.json"
    description: "ìµœì¢… PPTX íŒŒì¼ ëª…ëª… ê·œì¹™ ì ìš©({ì„¸ì…˜ID}_{ì„¸ì…˜ì œëª©}.pptx), ìƒì„± ë¦¬í¬íŠ¸ ì‘ì„±(ì†Œìš” ì‹œê°„, ë¶„í• /ë³‘í•© ì´ë ¥, ì¬ì œì¶œ íšŸìˆ˜), í”„ë¡œì íŠ¸ í´ë” ì •ë¦¬ë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤."
